Grammar:

cmdlin:
    assgn
    arglist

assgn:
    lvalue '=' word

lvalue:
    name
    name indexexpr

name:
    namstart
    namstart namend

namstart:
    '[[:alpha:]$]'

namend:
    namchar
    namchar namend

namchar:
    '[[:alpha:][:digit:]$]'

indexexpr:
    '.' word

word:
    lvalue
    stringexpr
    block
    list
    intexpr

stringexpr:
    formatstring
    formatstring ',' farglist

formatstring:
    '"' text '"'

text:
    textchar
    textchar text

textchar:
    '[^"\[:cntrl:]]'
    escseq
    formatseq

escseq:
    '\' escspec

escspec:
    '[N"\]'

formatseq:
    '%' formatspec

formatspec:
    '[%DS]'

farglist:
    word
    word ',' farglist

block:
    '{' cmdlist '}

cmdlist:
    cmdlin
    cmdlin '\n' cmdlist

list:
    '[' cmdlist ']'

intexpr:
    bitexpr
    uop bitexpr

bitexpr:
    eqexpr
    eqexpr bitop bitexpr

eqexpr:
    addexpr
    addexpr eqop eqexpr

addexpr:
    mulexpr
    mulexpr addop addexpr

mulexpr:
    term
    term mulop mulexpr

term:
    block
    lvalue
    intterm
    parenterm

intterm:
    intchar
    intchar intterm

intchar:
    [[:digit:]]

parenterm:
    '(' intexpr ')'

uop:
    [~-+]

bitop:
    [&|]

eqop:
    (==|!=|<|>|<=|>=)

addop:
    [+-]

mulop:
    [*/%]

arglist:
    word
    word space arglist

space:
    ' '
    ' ' space

