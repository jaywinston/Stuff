Grammar:

cmdline:
    assgn
    arglist

assgn:
    name '=' word

name:
    namstart
    namstart namend

namstart:
    (?![ ={}()"+*/%[:digit:]-])[[:graph:]]

namend:
    namchar
    namchar namend

namchar:
    (?![ ={}()"+*/%-])[[:graph:]]

word:
    expression
    block

expression:
    stringexpr
    intexpr

stringexpr:
    '"' text '"'

text:
    textchar
    textchar text

textchar:
    (?![%"])[[:graph:]]
    formatseq

formatseq:
    '%' formatspec

formatspec:
    'p' 'q'

intexpr:
    blockexpr
    addexpr
    addexpr op blockexpr

blockexpr:
    block
    block op intexpr
    parenexpr

parenexpr:
    parenatom
    parenatom op intexpr

addexpr:
    mulexpr
    mulexpr addop addexpr

mulexpr:
    atom
    atom mulop mulexpr

atom:
    name
    intatom
    parenatom
    block

intatom:
    intchar
    intchar intatom

intchar:
    [[:digit:]]

parenatom:
    '(' addexpr ')

block:
    '{' cmdlist '}

cmdlist:
    cmdlin
    cmdlin 'newline' cmdlist

op:
    addop
    mulop

addop:
    '+' '-'

mulop:
    '*' '/' '%'

arglist:
    word
    word space arglist

space:
    'blank'
    'blank' space

